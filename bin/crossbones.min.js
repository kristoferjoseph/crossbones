// Crossbones.js 0.0.1-alpha
// Build Date: 2012-09-30

// (c) 2012 Kristofer Joseph.
// Crossbones.js may be freely distributed under the MIT license.
// For all details and documentation:
// http://www.crossbonesjs.org
(function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Crossbones=e.Crossbones||{};var n=t.FilterableCollection=Backbone.Collection.extend({filters:new Backbone.Collection,tempCollection:new Backbone.Collection,arrayByNameFilterFunction:function(e,t){return function(n){var r=n.get(e);for(var i=0;i<r.length;i++)if(r[i]===t)return!0;return!1}},propertyByValueFilterFunction:function(e,t){return function(n){return n.get(e)===t}},stringInPropertyFilterFunction:function(e,t){return function(n){var r=n.get(e).toLowerCase();return r.indexOf(t.toLowerCase())!==-1}},addFilter:function(e){return this.filters.add(e),this.applyFilters()},removeFilter:function(e){return this.filters.remove(this.filters.get(e)),this.applyFilters()},replaceFilter:function(e){var t=this.filters.get(e.id);return t&&this.removeFilter(t),this.addFilter(e)},removeAllFilters:function(){this.filters.reset()},applyFilters:function(){var e=this,t=this.tempCollection.reset(e.toJSON());return e.filters.each(function(n){var r=e[n.get("filterFunction")],i=n.get("args")||[];r&&t.reset(t.filter(r.apply(e,i)),{silent:!0})}),t.toJSON()},destroy:function(){this.removeAllFilters(),this.tempCollection.reset(),this.filters=null,this.tempCollection=null}})})(this);